<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/davinci-eight/math/Matrix4.ts - davinci-eight</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../../assets/logo.png" title="davinci-eight"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 2.48.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/AmbientLight.html">AmbientLight</a></li>
                                <li><a href="../classes/ArrowBuilder.html">ArrowBuilder</a></li>
                                <li><a href="../classes/ArrowOptions.html">ArrowOptions</a></li>
                                <li><a href="../classes/AttribMetaInfo.html">AttribMetaInfo</a></li>
                                <li><a href="../classes/AttribMetaInfos.html">AttribMetaInfos</a></li>
                                <li><a href="../classes/AttribProvider.html">AttribProvider</a></li>
                                <li><a href="../classes/BoxBuilder.html">BoxBuilder</a></li>
                                <li><a href="../classes/BoxMesh.html">BoxMesh</a></li>
                                <li><a href="../classes/Cartesian3.html">Cartesian3</a></li>
                                <li><a href="../classes/Color.html">Color</a></li>
                                <li><a href="../classes/Color
                WARNING: In many object-oriented designs, types representing values are completely immutable.
                In a graphics library where data changes rapidly and garbage collection might become an issue,
                it is common to use reference types, such as in this design. This mutability can lead to
                difficult bugs because it is hard to reason about where a color may have changed..html">Color
                WARNING: In many object-oriented designs, types representing values are completely immutable.
                In a graphics library where data changes rapidly and garbage collection might become an issue,
                it is common to use reference types, such as in this design. This mutability can lead to
                difficult bugs because it is hard to reason about where a color may have changed.</a></li>
                                <li><a href="../classes/CuboidMesh.html">CuboidMesh</a></li>
                                <li><a href="../classes/CylinderBuilder.html">CylinderBuilder</a></li>
                                <li><a href="../classes/DefaultUniformProvider.html">DefaultUniformProvider</a></li>
                                <li><a href="../classes/DirectionalLight.html">DirectionalLight</a></li>
                                <li><a href="../classes/Drawable.html">Drawable</a></li>
                                <li><a href="../classes/DrawMode.html">DrawMode</a></li>
                                <li><a href="../classes/ElementArray.html">ElementArray</a></li>
                                <li><a href="../classes/EllipsoidMesh.html">EllipsoidMesh</a></li>
                                <li><a href="../classes/Face3.html">Face3</a></li>
                                <li><a href="../classes/Frustum.html">Frustum</a></li>
                                <li><a href="../classes/frustum.html">frustum</a></li>
                                <li><a href="../classes/Geometry.html">Geometry</a></li>
                                <li><a href="../classes/GeometryAdapter.html">GeometryAdapter</a></li>
                                <li><a href="../classes/KleinBottleGeometry.html">KleinBottleGeometry</a></li>
                                <li><a href="../classes/Line3.html">Line3</a></li>
                                <li><a href="../classes/LocalModel.html">LocalModel</a></li>
                                <li><a href="../classes/Matrix4.html">Matrix4</a></li>
                                <li><a href="../classes/Model.html">Model</a></li>
                                <li><a href="../classes/Mutable.html">Mutable</a></li>
                                <li><a href="../classes/Node.html">Node</a></li>
                                <li><a href="../classes/Node3D.html">Node3D</a></li>
                                <li><a href="../classes/perspective.html">perspective</a></li>
                                <li><a href="../classes/Perspective.html">Perspective</a></li>
                                <li><a href="../classes/Point3.html">Point3</a></li>
                                <li><a href="../classes/PointLight.html">PointLight</a></li>
                                <li><a href="../classes/Renderer.html">Renderer</a></li>
                                <li><a href="../classes/RenderingContextUser.html">RenderingContextUser</a></li>
                                <li><a href="../classes/ShaderAttribLocation.html">ShaderAttribLocation</a></li>
                                <li><a href="../classes/ShaderAttribLocation..html">ShaderAttribLocation.</a></li>
                                <li><a href="../classes/ShaderProgram.html">ShaderProgram</a></li>
                                <li><a href="../classes/ShaderUniformLocation.html">ShaderUniformLocation</a></li>
                                <li><a href="../classes/ShaderVariableDecl.html">ShaderVariableDecl</a></li>
                                <li><a href="../classes/Spinor3.html">Spinor3</a></li>
                                <li><a href="../classes/Symbolic
                Canonical variable names, which act as semantic identifiers..html">Symbolic
                Canonical variable names, which act as semantic identifiers.</a></li>
                                <li><a href="../classes/TreeModel.html">TreeModel</a></li>
                                <li><a href="../classes/UniformColor.html">UniformColor</a></li>
                                <li><a href="../classes/UniformFloat.html">UniformFloat</a></li>
                                <li><a href="../classes/UniformMetaInfo.html">UniformMetaInfo</a></li>
                                <li><a href="../classes/UniformMetaInfos.html">UniformMetaInfos</a></li>
                                <li><a href="../classes/UniformProvider.html">UniformProvider</a></li>
                                <li><a href="../classes/UniformSpinor3.html">UniformSpinor3</a></li>
                                <li><a href="../classes/UniformVariable.html">UniformVariable</a></li>
                                <li><a href="../classes/UniformVector3.html">UniformVector3</a></li>
                                <li><a href="../classes/Vector3.html">Vector3</a></li>
                                <li><a href="../classes/View.html">View</a></li>
                                <li><a href="../classes/view.html">view</a></li>
                                <li><a href="../classes/Viewport.html">Viewport</a></li>
                                <li><a href="../classes/WebGLRenderer.html">WebGLRenderer</a></li>
                                <li><a href="../classes/WindowAnimationRunner.html">WindowAnimationRunner</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/EIGHT.html">EIGHT</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/davinci-eight/math/Matrix4.ts</h1>

<div class="file">
    <pre class="code prettyprint linenums">
import Spinor3Coords = require(&#x27;../math/Spinor3Coords&#x27;);
import Cartesian3 = require(&#x27;../math/Cartesian3&#x27;);
import expectArg = require(&#x27;../checks/expectArg&#x27;);
import isDefined = require(&#x27;../checks/isDefined&#x27;);
/**
 * 4x4 matrix integrating with WebGL.
 *
 * @class Matrix4
 */
class Matrix4 {
// The correspondence between the elements property index and the matrix entries is...
//
//  0  4  8 12
//  1  5  9 13
//  2  6 10 14
//  3  7 11 15
  /**
   * @property elements
   * @type Float32Array
   */
  public elements: Float32Array;
  /**
   * Constructs the Matrix4 by wrapping a Float32Array.
   * @constructor
   */
  constructor(elements: Float32Array) {
    expectArg(&#x27;elements&#x27;, elements)
    .toSatisfy(elements instanceof Float32Array, &quot;elements must be a Float32Array&quot;)
    .toSatisfy(elements.length === 16, &#x27;elements must have length 16&#x27;);
    this.elements = elements;
  }
  public static identity() {
    return new Matrix4(new Float32Array([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]));
  }
  public static scaling(scale: Cartesian3): Matrix4 {
    return Matrix4.identity().scaling(scale);
  }
  public static translation(vector: Cartesian3): Matrix4 {
    return Matrix4.identity().translation(vector);
  }
  public static rotation(spinor: Spinor3Coords): Matrix4 {
    if (isDefined(spinor)) {
      expectArg(&#x27;spinor&#x27;, spinor).toBeObject();
      return Matrix4.identity().rotation(spinor);
    }
    else {
      return;
    }
  }
  clone(): Matrix4 {
    return Matrix4.identity().copy(this);
  }
  compose(scale: Cartesian3, attitude: Spinor3Coords, position: Cartesian3): Matrix4 {
    // We 
    // this.identity();
    // this.scale(scale);
    this.scaling(scale);
    this.rotate(attitude);
    this.translate(position);
    return this;
  }
  copy(m: Matrix4): Matrix4 {
    this.elements.set(m.elements);
    return this;
  }
  determinant(): number {
    let te = this.elements;

    let n11 = te[0], n12 = te[4], n13 = te[8], n14 = te[12];
    let n21 = te[1], n22 = te[5], n23 = te[9], n24 = te[13];
    let n31 = te[2], n32 = te[6], n33 = te[10], n34 = te[14];
    let n41 = te[3], n42 = te[7], n43 = te[11], n44 = te[15];

    //( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )

    let n1122 = n11 * n22;
    let n1123 = n11 * n23;
    let n1124 = n11 * n24;
    let n1221 = n12 * n21;
    let n1223 = n12 * n23;
    let n1224 = n12 * n24;
    let n1321 = n13 * n21;
    let n1322 = n13 * n22;
    let n1324 = n13 * n24;
    let n1421 = n14 * n21;
    let n1422 = n14 * n22;
    let n1423 = n14 * n23;

    return n41 * ((n1423 - n1324) * n32 + (n1224 - n1422) * n33 + (n1322 - n1223) * n34) +
           n42 * ((n1324 - n1423) * n31 + (n1421 - n1124) * n33 + (n1123 - n1321) * n34) +
           n43 * ((n1422 - n1224) * n31 + (n1124 - n1421) * n32 + (n1221 - n1122) * n34) +
           n44 * ((n1223 - n1322) * n31 + (n1321 - n1123) * n32 + (n1122 - n1221) * n33);
  }
  invert(m: Matrix4, throwOnSingular: boolean = false): Matrix4 {

    // based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm
    var te = this.elements;
    var me = m.elements;

    var n11 = me[ 0 ], n12 = me[ 4 ], n13 = me[ 8 ], n14 = me[ 12 ];
    var n21 = me[ 1 ], n22 = me[ 5 ], n23 = me[ 9 ], n24 = me[ 13 ];
    var n31 = me[ 2 ], n32 = me[ 6 ], n33 = me[ 10 ], n34 = me[ 14 ];
    var n41 = me[ 3 ], n42 = me[ 7 ], n43 = me[ 11 ], n44 = me[ 15 ];

    te[ 0 ] = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44;
    te[ 4 ] = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44;
    te[ 8 ] = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44;
    te[ 12 ] = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;
    te[ 1 ] = n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44;
    te[ 5 ] = n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44;
    te[ 9 ] = n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44;
    te[ 13 ] = n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34;
    te[ 2 ] = n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44;
    te[ 6 ] = n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44;
    te[ 10 ] = n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44;
    te[ 14 ] = n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34;
    te[ 3 ] = n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43;
    te[ 7 ] = n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43;
    te[ 11 ] = n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43;
    te[ 15 ] = n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33;

    let det = n11 * te[ 0 ] + n21 * te[ 4 ] + n31 * te[ 8 ] + n41 * te[ 12 ];

    if (det !== 0) {
      return this.multiplyScalar(1 / det);
    }
    else {
      let msg = &quot;Matrix4.getInverse(): can&#x27;t invert matrix, determinant is 0&quot;;
      if (throwOnSingular) {
        throw new Error( msg );
      }
      else {
        console.warn( msg );
      }
      this.identity();
      return this;
    }
  }
  identity(): Matrix4 {
    return this.set(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);
  }
  multiplyScalar(s): Matrix4 {
    let te = this.elements;
    te[ 0 ] *= s; te[ 4 ] *= s; te[ 8 ] *= s; te[ 12 ] *= s;
    te[ 1 ] *= s; te[ 5 ] *= s; te[ 9 ] *= s; te[ 13 ] *= s;
    te[ 2 ] *= s; te[ 6 ] *= s; te[ 10 ] *= s; te[ 14 ] *= s;
    te[ 3 ] *= s; te[ 7 ] *= s; te[ 11 ] *= s; te[ 15 ] *= s;
    return this;
  }
  transpose(): Matrix4 {
    let te: Float32Array = this.elements;
    var tmp: number;

    tmp = te[ 1 ]; te[ 1 ] = te[ 4 ]; te[ 4 ] = tmp;
    tmp = te[ 2 ]; te[ 2 ] = te[ 8 ]; te[ 8 ] = tmp;
    tmp = te[ 6 ]; te[ 6 ] = te[ 9 ]; te[ 9 ] = tmp;

    tmp = te[ 3 ]; te[ 3 ] = te[ 12 ]; te[ 12 ] = tmp;
    tmp = te[ 7 ]; te[ 7 ] = te[ 13 ]; te[ 13 ] = tmp;
    tmp = te[ 11 ]; te[ 11 ] = te[ 14 ]; te[ 14 ] = tmp;

    return this;
  }
  /**
   *
   */
  frustum(left: number, right: number, bottom: number, top: number, near: number, far: number): Matrix4 {
    let te = this.elements;
    let x = 2 * near / ( right - left );
    let y = 2 * near / ( top - bottom );

    let a = ( right + left ) / ( right - left );
    let b = ( top + bottom ) / ( top - bottom );
    let c = - ( far + near ) / ( far - near );
    let d = - 2 * far * near / ( far - near );

    te[ 0 ] = x;  te[ 4 ] = 0;  te[ 8 ]  = a;  te[ 12 ] = 0;
    te[ 1 ] = 0;  te[ 5 ] = y;  te[ 9 ]  = b;  te[ 13 ] = 0;
    te[ 2 ] = 0;  te[ 6 ] = 0;  te[ 10 ] = c;  te[ 14 ] = d;
    te[ 3 ] = 0;  te[ 7 ] = 0;  te[ 11 ] = -1;  te[ 15 ] = 0;

    return this;
  }
  rotationAxis(axis: Cartesian3, angle: number) {

    // Based on http://www.gamedev.net/reference/articles/article1199.asp

    let c = Math.cos( angle );
    let s = Math.sin( angle );
    let t = 1 - c;
    let x = axis.x, y = axis.y, z = axis.z;
    let tx = t * x, ty = t * y;

    return this.set(
      tx * x + c, tx * y - s * z, tx * z + s * y, 0,
      tx * y + s * z, ty * y + c, ty * z - s * x, 0,
      tx * z - s * y, ty * z + s * x, t * z * z + c, 0,
      0, 0, 0, 1
    );
  }
  mul(m: Matrix4): Matrix4 {
    return Matrix4.mul(this, m, this);
  }
  multiplyMatrices(a: Matrix4, b: Matrix4): Matrix4 {
    return Matrix4.mul(a, b, this);
  }
  static mul(a: Matrix4, b: Matrix4, out: Matrix4): Matrix4 {
    var ae = a.elements;
    var be = b.elements;
    var oe: Float32Array = out.elements;

    var a11 = ae[0x0], a12 = ae[0x4], a13 = ae[0x8], a14 = ae[0xC];
    var a21 = ae[0x1], a22 = ae[0x5], a23 = ae[0x9], a24 = ae[0xD];
    var a31 = ae[0x2], a32 = ae[0x6], a33 = ae[0xA], a34 = ae[0xE];
    var a41 = ae[0x3], a42 = ae[0x7], a43 = ae[0xB], a44 = ae[0xF];

    var b11 = be[ 0 ], b12 = be[ 4 ], b13 = be[ 8 ], b14 = be[ 12 ];
    var b21 = be[ 1 ], b22 = be[ 5 ], b23 = be[ 9 ], b24 = be[ 13 ];
    var b31 = be[ 2 ], b32 = be[ 6 ], b33 = be[ 10 ], b34 = be[ 14 ];
    var b41 = be[ 3 ], b42 = be[ 7 ], b43 = be[ 11 ], b44 = be[ 15 ];

    oe[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;
    oe[ 4 ] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;
    oe[ 8 ] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;
    oe[ 12 ] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;

    oe[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;
    oe[ 5 ] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;
    oe[ 9 ] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;
    oe[ 13 ] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;

    oe[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;
    oe[ 6 ] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;
    oe[ 10 ] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;
    oe[ 14 ] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;

    out[ 3 ] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;
    out[ 7 ] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;
    out[ 11 ] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;
    out[ 15 ] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;

    return out;
  }
  /**
   * Sets the elements of the target matrix to the perspective transformation.
   * The perspective transformation maps homogeneous world coordinates into
   * a cubic viewing volume such that an orthogonal projection of that viewing
   * volume will give the correct linear perspective.
   * @method perspective
   * @param fov {Number} field of view in the vertical direction, measured in radians.
   * @param aspect {Number} The ratio of view width divided by view height.
   * @param near {Number} The distance to the near field plane.
   * @param far {Number} The distance to the far field plane.
   */
  perspective(fov: number, aspect: number, near: number, far: number): Matrix4 {
    // We can leverage the frustum function, although technically the
    // symmetry in this perspective transformation should reduce the amount
    // of computation required.
    let ymax: number = near * Math.tan(fov * 0.5);   // top
    let ymin: number = - ymax;                       // bottom
    let xmin: number = ymin * aspect;                // left
    let xmax: number = ymax * aspect;                // right
    return this.frustum(xmin, xmax, ymin, ymax, near, far);
  }
  rotate(spinor: Spinor3Coords): Matrix4 {
    let S = Matrix4.rotation(spinor);
    return Matrix4.mul(S, this, this);
  }
  /**
   * @method rotate
   * @param attitude  The spinor from which the rotation will be computed.
   */
  rotation(spinor: Spinor3Coords): Matrix4 {
    // The correspondence between quaternions and spinors is
    // i &lt;=&gt; -e2^e3, j &lt;=&gt; -e3^e1, k &lt;=&gt; -e1^e2.
    let x: number = -expectArg(&#x27;spinor.yz&#x27;, spinor.yz).toBeNumber().value;
    let y: number = -expectArg(&#x27;spinor.zx&#x27;, spinor.zx).toBeNumber().value;
    let z: number = -expectArg(&#x27;spinor.xy&#x27;, spinor.xy).toBeNumber().value;
    let w: number =  expectArg(&#x27;spinor.w&#x27;,  spinor.w).toBeNumber().value;

    let x2 = x + x, y2 = y + y, z2 = z + z;
    let xx = x * x2, xy = x * y2, xz = x * z2;
    let yy = y * y2, yz = y * z2, zz = z * z2;
    let wx = w * x2, wy = w * y2, wz = w * z2;

    this.set(
      1 - yy - zz, xy - wz,     xz + wy,     0,
      xy + wz,     1 - xx - zz, yz - wx,     0,
      xz - wy,     yz + wx,     1 - xx - yy, 0,
      0,           0,           0,           1
      );

    return this;
  }
  /**
   * @method
   * @param i {number} the zero-based index of the row.
   */
  row(i: number): number[] {
    let te = this.elements;
    return [te[0 + i], te[4 + i], te[8 + i], te[12 + i]];
  }
  /**
   *
   */
  scale(scale: Cartesian3): Matrix4 {
    // We treat the scale operation as pre-multiplication: 
    // |x 0 0 0|   |m[0] m[4] m[8] m[C]|   |x * m[0] x * m[4] x * m[8] x * m[C]|
    // |0 y 0 0| * |m[1] m[5] m[9] m[D]| = |y * m[1] y * m[5] y * m[9] y * m[D]|
    // |0 0 z 0|   |m[2] m[6] m[A] m[E]|   |z * m[2] z * m[6] z * m[A] z * m[E]|
    // |0 0 0 1|   |m[3] m[7] m[B] m[F]|   |    m[3]     m[7]     m[B]     m[F]|

    // The following would be post-multiplication:
    // |m[0] m[4] m[8] m[C]|   |x 0 0 0|   |x * m[0] y * m[4] z * m[8]     m[C]|
    // |m[1] m[5] m[9] m[D]| * |0 y 0 0| = |x * m[1] y * m[5] z * m[9]     m[D]|
    // |m[2] m[6] m[A] m[E]|   |0 0 z 0|   |x * m[2] y * m[6] z * m[A]     m[E]|
    // |m[3] m[7] m[B] m[F]|   |0 0 0 1|   |x * m[3] y * m[7] z * m[B]     m[F]|
    let S = Matrix4.scaling(scale);
    return Matrix4.mul(S, this, this);
  }
  scaling(scale: Cartesian3): Matrix4 {
    return this.set(scale.x, 0, 0, 0, 0, scale.y, 0, 0, 0, 0, scale.z, 0, 0, 0, 0, 1);
  }
  set(
    n11: number,
    n12: number,
    n13: number,
    n14: number,
    n21: number,
    n22: number,
    n23: number,
    n24: number,
    n31: number,
    n32: number,
    n33: number,
    n34: number,
    n41: number,
    n42: number,
    n43: number,
    n44: number): Matrix4 {

    var te = this.elements;

    te[ 0 ] = n11; te[ 4 ] = n12; te[ 8 ] = n13; te[ 12 ] = n14;
    te[ 1 ] = n21; te[ 5 ] = n22; te[ 9 ] = n23; te[ 13 ] = n24;
    te[ 2 ] = n31; te[ 6 ] = n32; te[ 10 ] = n33; te[ 14 ] = n34;
    te[ 3 ] = n41; te[ 7 ] = n42; te[ 11 ] = n43; te[ 15 ] = n44;

    return this;
  }
  toFixed(digits?: number): string {
    if (isDefined(digits)) {expectArg(&#x27;digits&#x27;, digits).toBeNumber();}
    let text: string[] = [];
    for (var i = 0; i &lt;= 3;i++) {
      text.push(this.row(i).map(function(element: number, index: number) { return element.toFixed(digits) }).join(&#x27; &#x27;));
    }
    return text.join(&#x27;\n&#x27;);
  }
  toString(): string {
    let text: string[] = [];
    for (var i = 0; i &lt;= 3;i++) {
      text.push(this.row(i).map(function(element: number, index: number) { return element.toString() }).join(&#x27; &#x27;));
    }
    return text.join(&#x27;\n&#x27;);
  }
  translate(displacement: Cartesian3): Matrix4 {
    let T = Matrix4.translation(displacement);
    return Matrix4.mul(T, this, this);
  }
  translation(displacement: Cartesian3): Matrix4 {
    return this.set(1, 0, 0, displacement.x, 0, 1, 0, displacement.y, 0, 0, 1, displacement.z, 0, 0, 0, 1);
  }
  __mul__(other: any): Matrix4 {
    if (other instanceof Matrix4) {
      return Matrix4.identity().multiplyMatrices(this, other);
    }
    else if (typeof other === &#x27;number&#x27;) {
      return this.clone().multiplyScalar(other);
    }
  }
  __rmul__(other: any): Matrix4 {
    if (other instanceof Matrix4) {
      return Matrix4.identity().multiplyMatrices(other, this);
    }
    else if (typeof other === &#x27;number&#x27;) {
      return this.clone().multiplyScalar(other);
    }
  }
}

export = Matrix4;

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
